!function(){"use strict";class e{constructor(e,t){let{items:s,renderer:r}=e;this._renderedItems=s,this._renderer=r,this._container=document.querySelector(t)}renderItems(){this._renderedItems.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.append(e)}prependItem(e){this._container.prepend(e)}}class t{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t),this._handleEscClose=this._handleEscClose.bind(this),this._handleClickClose=this._handleClickClose.bind(this)}open(){this._popupElement.classList.add("modal_opened"),this.setEventListeners()}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose),this._popupElement.removeEventListener("click",this._handleClickClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}_handleClickClose(e){(e.target.classList.contains("modal")||e.target.classList.contains("modal__button-exit"))&&this.close()}setEventListeners(){document.addEventListener("keydown",this._handleEscClose),this._popupElement.addEventListener("click",this._handleClickClose)}}class s extends t{constructor(e,t){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=t,this._inputs=this._popupForm.querySelectorAll(".form__input"),this._submitButton=this._popupForm.querySelector(".form__button"),this._submitButtonText=this._submitButton.textContent}setLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitButton.textContent=e?t:this._submitButtonText}_getInputValues(){const e={};return this._inputs.forEach((t=>{e[t.name]=t.value})),e}_submitForm=()=>{const e=this._getInputValues();this._handleFormSubmit(e)};setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",this._submitForm)}close(){this._popupForm.reset(),super.close(),this._popupForm.removeEventListener("submit",this._submitForm)}}const r=document.querySelector("#profile-edit-button"),i=document.querySelector("#form-input-name"),n=document.querySelector("#form-input-description"),o=document.querySelector("#card-add-button"),a=document.querySelector(".profile__photo-edit-button"),l=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}_handleServerResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}_request(e,t){return fetch(e,t).then(this._handleServerResponse)}getInitialCards(){return this._request(`${this._baseUrl}/cards`,{headers:this._headers})}getUserInfo(){return this._request(`${this._baseUrl}/users/me`,{headers:this._headers})}addCard(e){let{name:t,link:s}=e;return this._request(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:s})})}removeCard(e){return this._request(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers})}changeLikeStatus(e,t){return this._request(`${this._baseUrl}/cards/${e}/likes`,{method:t?"DELETE":"PUT",headers:this._headers})}updateUserInfo(e,t){return this._request(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})})}setUserAvatar(e){return this._request(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})})}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"5e1b3b9f-b018-4d2b-bc9a-2c16cad524b1","Content-Type":"application/json"}});let d,c;const h=new class extends t{constructor(e){super({popupSelector:e}),this._previewImage=document.querySelector(".modal__image"),this._previewCaption=document.querySelector(".modal__preview-caption")}open(e,t){this._previewImage.src=t,this._previewCaption.textContent=e,this._previewImage.alt=`Photo of ${e}`,super.open()}}("#modal-preview-image"),u=new s("#modal-add-card",(function(e){let{name:t,link:s}=e;u.setLoading(!0),l.addCard({name:t,link:s}).then((e=>{const t=f(e);d.prependItem(t),u.close()})).catch(console.error).finally((()=>{u.setLoading(!1)}))})),_=new s("#modal-profile-edit",(function(e){let{name:t,description:s}=e;_.setLoading(!0),l.updateUserInfo(t,s).then((()=>{E.setUserInfo(t,s),_.close()})).catch(console.error).finally((()=>{_.setLoading(!1)}))})),m=new class extends t{constructor(e){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._submitButton=this._popupForm.querySelector(".form__button"),this._submitButtonText=this._submitButton.textContent}setSubmitAction(e){this._handleFormSubmit=e}setLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Removing...";this._submitButton.textContent=e?t:this._submitButtonText}close(){super.close(),this._popupForm.removeEventListener("submit",this._handleFormSubmit)}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",this._handleFormSubmit)}}("#modal-card-delete"),p=new s("#modal-avatar-edit",(function(e){let{url:t}=e;p.setLoading(!0),l.setUserAvatar(t).then((e=>{E.setUserAvatar(e.avatar),p.close()})).catch(console.error).finally((()=>{p.setLoading(!1)}))})),E=new class{constructor(e,t,s){this._nameElement=e,this._descripElement=t,this._avatarElement=s}getUserInfo(){const e={};return e.profileName=this._nameElement.textContent,e.description=this._descripElement.textContent,e}setUserInfo(e,t){this._nameElement.textContent=e,this._descripElement.textContent=t}setUserAvatar(e){this._avatarElement.src=e,this._avatarElement.alt=this._nameElement.textContent}}(document.querySelector(".profile__name"),document.querySelector(".profile__subtitle"),document.querySelector(".profile__photo"));Promise.all([l.getInitialCards(),l.getUserInfo()]).then((t=>{let[s,r]=t;E.setUserInfo(r.name,r.about),E.setUserAvatar(r.avatar),c=r._id,d=new e({items:s,renderer:e=>{const t=f(e);d.addItem(t)}},".gallery__list"),d.renderItems()})).catch(console.error);const v={};function b(e){let{name:t,link:s}=e;h.open(t,s)}function f(e){const t=new class{constructor(e,t,s,r,i){this._name=e.name,this._link=e.link,this.isLiked=e.isLiked,this._ownerId=e.owner._id,this._cardId=e._id,this._cardTemplateSelector=t,this._handleCardClick=s,this._handleDeleteClick=r,this._handleLikeButtonClick=i}_toggleLikeButton(){this.isLiked?this._likeButton.classList.add("card__like-button_active"):this._likeButton.classList.remove("card__like-button_active")}updateLikes(e){this.isLiked=e,this._toggleLikeButton()}_setEventListeners(){this._cardImage.addEventListener("click",(()=>{this._handleCardClick({name:this._name,link:this._link})})),this._likeButton.addEventListener("click",(()=>{this._handleLikeButtonClick()})),this._deleteButton.addEventListener("click",(()=>this._handleDeleteClick()))}removeCardElement(){this._cardElement.remove()}_getTemplate(){return this._cardElement=document.querySelector(this._cardTemplateSelector).content.querySelector(".card").cloneNode(!0),this._cardElement}getView(){return this._cardElement=this._getTemplate(),this._cardImage=this._cardElement.querySelector(".card__image"),this._cardTitle=this._cardElement.querySelector(".card__title"),this._likeButton=this._cardElement.querySelector(".card__like-button"),this._likeCounter=this._cardElement.querySelector(".card__like-counter"),this._deleteButton=this._cardElement.querySelector(".card__delete-button"),this._cardImage.src=this._link,this._cardTitle.textContent=this._name,this._cardImage.alt=`Photo of ${this._name}`,this._setEventListeners(),this._toggleLikeButton(),this._cardElement}}(e,"#card-template",b,(function(){m.setSubmitAction((()=>{m.setLoading(!0),l.removeCard(e._id).then((e=>{t.removeCardElement(e._id),m.close()})).catch(console.error).finally((()=>{m.setLoading(!1)}))})),m.open()}),(function(){l.changeLikeStatus(e._id,t.isLiked).then((e=>{console.log(e),t.updateLikes(e.isLiked)})).catch(console.error)}));return t.getView()}var C;C={formSelector:".form",inputSelector:".form__input",submitButtonSelector:".form__button",inactiveButtonClass:"form__button_disabled",inputErrorClass:"form__input_type_error",errorClass:"form__error_visible"},Array.from(document.querySelectorAll(C.formSelector)).forEach((e=>{const t=new class{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t}_showInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}resetValidation(){this._toggleButtonState(),this._inputElements.forEach((e=>{this._hideInputError(e)}))}_toggleButtonState(){this._hasInvalidInput()?this._disableButton():(this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.disabled=!1)}_hasInvalidInput(){return this._inputElements.some((e=>!e.validity.valid))}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_disableButton(){this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.disabled=!0}_setEventListeners(){this._inputElements=[...this._form.querySelectorAll(this._inputSelector)],this._buttonElement=this._form.querySelector(this._submitButtonSelector),this._inputElements.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))})),this._toggleButtonState()}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}(C,e),s=e.getAttribute("name");v[s]=t,t.enableValidation()})),r.addEventListener("click",(()=>{const{profileName:e,description:t}=E.getUserInfo();i.value=e,n.value=t,_.open(),v["profile-form"].resetValidation()})),o.addEventListener("click",(()=>{u.open(),v["card-form"].resetValidation()})),a.addEventListener("click",(()=>{p.open(),v["avatar-form"].resetValidation()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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S2dMLGdCQUFnQkMsRUFJekIsQ0FFQVMsaUJBQ0UxTCxLQUFLMkwsZUFBZXRLLFVBQVVDLElBQUl0QixLQUFLNEssc0JBQ3ZDNUssS0FBSzJMLGVBQWVDLFVBQVcsQ0FDakMsQ0FFQXpDLHFCQUNFbkosS0FBS3dMLGVBQWlCLElBQUl4TCxLQUFLK0ssTUFBTXpJLGlCQUFpQnRDLEtBQUswSyxpQkFDM0QxSyxLQUFLMkwsZUFBaUIzTCxLQUFLK0ssTUFBTTFLLGNBQWNMLEtBQUsySyx1QkFFcEQzSyxLQUFLd0wsZUFBZWpMLFNBQVMwSyxJQUMzQkEsRUFBYWxKLGlCQUFpQixTQUFTLEtBQ3JDL0IsS0FBS2dNLG9CQUFvQmYsR0FDekJqTCxLQUFLdUwsb0JBQW9CLEdBQ3pCLElBRUp2TCxLQUFLdUwsb0JBQ1AsQ0FFQVUsbUJBQ0VqTSxLQUFLK0ssTUFBTWhKLGlCQUFpQixVQUFXSixJQUNyQ0EsRUFBSXVLLGdCQUFnQixJQUV0QmxNLEtBQUttSixvQkFDUCxHTmtCc0NZLEVBQVFTLEdBQ3RDMkIsRUFBVzNCLEVBQVk0QixhQUFhLFFBQzFDbEUsRUFBZWlFLEdBQVkxQixFQUMzQkEsRUFBVXdCLGtCQUFrQixJQXlHaEN6SSxFQUFrQnpCLGlCQUFpQixTQUFTLEtBQzFDLE1BQU0sWUFBRXNLLEVBQVcsWUFBRXpHLEdBQWdCdUIsRUFBU3BDLGNBQzlDdEIsRUFBVUwsTUFBUWlKLEVBQ2xCM0ksRUFBaUJOLE1BQVF3QyxFQUN6QnFCLEVBQWlCN0YsT0FDakI4RyxFQUFlLGdCQUFnQm9ELGlCQUFpQixJQUdsRDNILEVBQWM1QixpQkFBaUIsU0FBUyxLQUN0Q3lFLEVBQWFwRixPQUNiOEcsRUFBZSxhQUFhb0QsaUJBQWlCLElBRy9DMUgsRUFBaUI3QixpQkFBaUIsU0FBUyxLQUN6Q3lGLEVBQWdCcEcsT0FDaEI4RyxFQUFlLGVBQWVvRCxpQkFBaUIsRyIsInNvdXJjZXMiOlsid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Vc2VyaW5mby5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0Zvcm12YWxpZGF0b3IuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XG4gICAgdGhpcy5fcmVuZGVyZWRJdGVtcyA9IGl0ZW1zO1xuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XG4gIH1cblxuICByZW5kZXJJdGVtcygpIHtcbiAgICB0aGlzLl9yZW5kZXJlZEl0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xuICAgIH0pO1xuICB9XG5cbiAgYWRkSXRlbShlbGVtZW50KSB7XG4gICAgdGhpcy5fY29udGFpbmVyLmFwcGVuZChlbGVtZW50KTtcbiAgfVxuXG4gIHByZXBlbmRJdGVtKGVsZW1lbnQpIHtcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IgfSkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UgPSB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpO1xuICAgIHRoaXMuX2hhbmRsZUNsaWNrQ2xvc2UgPSB0aGlzLl9oYW5kbGVDbGlja0Nsb3NlLmJpbmQodGhpcyk7XG4gIH1cblxuICBvcGVuKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xuICAgIHRoaXMuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX2hhbmRsZUNsaWNrQ2xvc2UpO1xuICB9XG5cbiAgX2hhbmRsZUVzY0Nsb3NlKGV2dCkge1xuICAgIC8vIGNsb3NlcyBwb3B1cCBvbiAnZXNjYXBlJyBrZXlcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfVxuXG4gIF9oYW5kbGVDbGlja0Nsb3NlKGV2dCkge1xuICAgIC8vIGNsb3NlcyBwb3B1cCBvbiAnZXhpdCBidXR0b24nIGNsaWNrLCBvciBjbGlja2luZyBvdXRzaWRlIG9mIG1vZGFsXG4gICAgaWYgKFxuICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbFwiKSB8fFxuICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9fYnV0dG9uLWV4aXRcIilcbiAgICApIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9oYW5kbGVDbGlja0Nsb3NlKTtcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQpIHtcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XG4gICAgdGhpcy5faW5wdXRzID0gdGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuZm9ybV9faW5wdXRcIik7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9fYnV0dG9uXCIpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblRleHQgPSB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQ7XG4gIH1cblxuICBzZXRMb2FkaW5nKGlzTG9hZGluZywgbG9hZGluZ1RleHQgPSBcIlNhdmluZy4uLlwiKSB7XG4gICAgaWYgKGlzTG9hZGluZykge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gbG9hZGluZ1RleHQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuX3N1Ym1pdEJ1dHRvblRleHQ7XG4gICAgfVxuICB9XG5cbiAgX2dldElucHV0VmFsdWVzKCkge1xuICAgIGNvbnN0IGlucHV0c09iaiA9IHt9O1xuICAgIHRoaXMuX2lucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgaW5wdXRzT2JqW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gaW5wdXRzT2JqO1xuICB9XG5cbiAgX3N1Ym1pdEZvcm0gPSAoKSA9PiB7XG4gICAgY29uc3QgaW5wdXRWYWx1ZXMgPSB0aGlzLl9nZXRJbnB1dFZhbHVlcygpO1xuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQoaW5wdXRWYWx1ZXMpO1xuICB9O1xuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgdGhpcy5fc3VibWl0Rm9ybSk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9wb3B1cEZvcm0ucmVzZXQoKTtcbiAgICBzdXBlci5jbG9zZSgpO1xuICAgIHRoaXMuX3BvcHVwRm9ybS5yZW1vdmVFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIHRoaXMuX3N1Ym1pdEZvcm0pO1xuICB9XG59XG4iLCJleHBvcnQgY29uc3QgY29uZmlnID0ge1xuICBmb3JtU2VsZWN0b3I6IFwiLmZvcm1cIixcbiAgaW5wdXRTZWxlY3RvcjogXCIuZm9ybV9faW5wdXRcIixcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLmZvcm1fX2J1dHRvblwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcImZvcm1fX2J1dHRvbl9kaXNhYmxlZFwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwiZm9ybV9faW5wdXRfdHlwZV9lcnJvclwiLFxuICBlcnJvckNsYXNzOiBcImZvcm1fX2Vycm9yX3Zpc2libGVcIixcbn07XG5cbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1lZGl0LWJ1dHRvblwiKTtcbmV4cG9ydCBjb25zdCBpbnB1dE5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2Zvcm0taW5wdXQtbmFtZVwiKTtcbmV4cG9ydCBjb25zdCBpbnB1dERlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIjZm9ybS1pbnB1dC1kZXNjcmlwdGlvblwiXG4pO1xuZXhwb3J0IGNvbnN0IGNhcmRBZGRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtYWRkLWJ1dHRvblwiKTtcbmV4cG9ydCBjb25zdCBhdmF0YXJFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIucHJvZmlsZV9fcGhvdG8tZWRpdC1idXR0b25cIlxuKTtcblxuLy8gZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcbi8vICAge1xuLy8gICAgIG5hbWU6IFwiQWxhdmVyZGksIEFybWVuaWFcIixcbi8vICAgICBsaW5rOiBcImh0dHBzOi8vaW1hZ2VzLnVuc3BsYXNoLmNvbS9waG90by0xNTQzODYyNDc1LWViMTM2NzcwYWU5Yj9peGxpYj1yYi00LjAuMyZpeGlkPU1ud3hNakEzZkRCOE1IeHdhRzkwYnkxd1lXZGxmSHg4ZkdWdWZEQjhmSHg4JmF1dG89Zm9ybWF0JmZpdD1jcm9wJnc9ODcwJnE9ODBcIixcbi8vICAgfSxcbi8vICAge1xuLy8gICAgIG5hbWU6IFwiQW5na29yIFdhdCwgQ2FtYm9kaWFcIixcbi8vICAgICBsaW5rOiBcImh0dHBzOi8vaW1hZ2VzLnVuc3BsYXNoLmNvbS9waG90by0xNjAwODA3NDU1MjQ5LTg5ZDJlMjg1YjllMD9peGxpYj1yYi00LjAuMyZpeGlkPU1ud3hNakEzZkRCOE1IeHdhRzkwYnkxd1lXZGxmSHg4ZkdWdWZEQjhmSHg4JmF1dG89Zm9ybWF0JmZpdD1jcm9wJnc9Njg3JnE9ODBcIixcbi8vICAgfSxcbi8vICAge1xuLy8gICAgIG5hbWU6IFwiQXJjaGVzIE5hdGlvbmFsIFBhcmssIFVTQVwiLFxuLy8gICAgIGxpbms6IFwiaHR0cHM6Ly9pbWFnZXMudW5zcGxhc2guY29tL3Bob3RvLTE1MjczMzM2NTYwNjEtY2E3YWRmNjA4YWUxP2l4bGliPXJiLTQuMC4zJml4aWQ9TW53eE1qQTNmREI4TUh4d2FHOTBieTF3WVdkbGZIeDhmR1Z1ZkRCOGZIeDgmYXV0bz1mb3JtYXQmZml0PWNyb3Amdz0xMzc0JnE9ODBcIixcbi8vICAgfSxcbi8vICAge1xuLy8gICAgIG5hbWU6IFwiUmVkd29vZCBOYXRpb25hbCBQYXJrLCBVU0FcIixcbi8vICAgICBsaW5rOiBcImh0dHBzOi8vaW1hZ2VzLnVuc3BsYXNoLmNvbS9waG90by0xNTQ3MDE0NzYyLTNhOTRmYjRkZjcwYT9peGxpYj1yYi00LjAuMyZpeGlkPU1ud3hNakEzZkRCOE1IeHdhRzkwYnkxd1lXZGxmSHg4ZkdWdWZEQjhmSHg4JmF1dG89Zm9ybWF0JmZpdD1jcm9wJnc9Njg2JnE9ODBcIixcbi8vICAgfSxcbi8vICAge1xuLy8gICAgIG5hbWU6IFwiTW91bnQgRnVqaSwgSmFwYW5cIixcbi8vICAgICBsaW5rOiBcImh0dHBzOi8vaW1hZ2VzLnVuc3BsYXNoLmNvbS9waG90by0xNDkwODA2ODQzOTU3LTMxZjRjOWE5MWM2NT9peGxpYj1yYi00LjAuMyZpeGlkPU1ud3hNakEzZkRCOE1IeHdhRzkwYnkxd1lXZGxmSHg4ZkdWdWZEQjhmSHg4JmF1dG89Zm9ybWF0JmZpdD1jcm9wJnc9MTc0MCZxPTgwXCIsXG4vLyAgIH0sXG4vLyAgIHtcbi8vICAgICBuYW1lOiBcIkRlYWR2bGVpLCBOYW1pYmlhXCIsXG4vLyAgICAgbGluazogXCJodHRwczovL2ltYWdlcy51bnNwbGFzaC5jb20vcGhvdG8tMTQ0ODgzMTMzODE4Ny03ODI5NmU2ZmRjNGQ/aXhsaWI9cmItNC4wLjMmaXhpZD1Nbnd4TWpBM2ZEQjhNSHh3YUc5MGJ5MXdZV2RsZkh4OGZHVnVmREI4Zkh4OCZhdXRvPWZvcm1hdCZmaXQ9Y3JvcCZ3PTE3MzgmcT04MFwiLFxuLy8gICB9LFxuLy8gXTtcbiIsImltcG9ydCBcIi4vaW5kZXguY3NzXCI7XG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtdmFsaWRhdG9yLmpzXCI7XG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VyaW5mby5qc1wiO1xuaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGkuanNcIjtcbmltcG9ydCBQb3B1cFdpdGhDb25maXJtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm1cIjtcbmltcG9ydCB7IGNvbmZpZyB9IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcbmltcG9ydCB7XG4gIHByb2ZpbGVFZGl0QnV0dG9uLFxuICBpbnB1dE5hbWUsXG4gIGlucHV0RGVzY3JpcHRpb24sXG4gIGNhcmRBZGRCdXR0b24sXG4gIGF2YXRhckVkaXRCdXR0b24sXG59IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcblxuLypcbiAg4pSM4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSQXG4gIOKUgiBBUEkgSU5TVEFOQ0UgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICDilIJcbiAg4pSU4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSYXG4gKi9cblxuY29uc3QgYXBpID0gbmV3IEFwaSh7XG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcbiAgaGVhZGVyczoge1xuICAgIGF1dGhvcml6YXRpb246IFwiNWUxYjNiOWYtYjAxOC00ZDJiLWJjOWEtMmMxNmNhZDUyNGIxXCIsXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gIH0sXG59KTtcblxubGV0IGNhcmRTZWN0aW9uO1xubGV0IHVzZXJJZDtcblxuLypcbiAg4pSM4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSQXG4gIOKUgiBQT1BVUCBFTEVNRU5UUyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICDilIJcbiAg4pSU4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSYXG4gKi9cblxuY29uc3QgaW1hZ2VQcmV2aWV3UG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIjbW9kYWwtcHJldmlldy1pbWFnZVwiKTtcblxuY29uc3QgYWRkQ2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjbW9kYWwtYWRkLWNhcmRcIiwgaGFuZGxlQ2FyZEZvcm1TdWJtaXQpO1xuXG5jb25zdCBlZGl0UHJvZmlsZVBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXG4gIFwiI21vZGFsLXByb2ZpbGUtZWRpdFwiLFxuICBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdFxuKTtcblxuY29uc3QgY2FyZERlbGV0ZVBvcHVwID0gbmV3IFBvcHVwV2l0aENvbmZpcm0oXCIjbW9kYWwtY2FyZC1kZWxldGVcIik7XG5cbmNvbnN0IGF2YXRhckVkaXRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICBcIiNtb2RhbC1hdmF0YXItZWRpdFwiLFxuICBoYW5kbGVBdmF0YXJGb3JtU3VibWl0XG4pO1xuXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyhcbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19uYW1lXCIpLFxuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX3N1YnRpdGxlXCIpLFxuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX3Bob3RvXCIpXG4pO1xuXG4vKlxuICDilIzilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilJBcbiAg4pSCIExPQUQgSU5JVElBTCBDQVJEUy8gVVNFUiBJTkZPIEZST00gU0VSVkVSICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIOKUglxuICDilJTilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilJhcbiAqL1xuXG5Qcm9taXNlLmFsbChbYXBpLmdldEluaXRpYWxDYXJkcygpLCBhcGkuZ2V0VXNlckluZm8oKV0pXG4gIC50aGVuKChbaW5pdGlhbENhcmRzLCB1c2VyRGF0YV0pID0+IHtcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyh1c2VyRGF0YS5uYW1lLCB1c2VyRGF0YS5hYm91dCk7XG4gICAgdXNlckluZm8uc2V0VXNlckF2YXRhcih1c2VyRGF0YS5hdmF0YXIpO1xuICAgIHVzZXJJZCA9IHVzZXJEYXRhLl9pZDtcbiAgICBjYXJkU2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxuICAgICAge1xuICAgICAgICBpdGVtczogaW5pdGlhbENhcmRzLFxuICAgICAgICByZW5kZXJlcjogKGNhcmREYXRhKSA9PiB7XG4gICAgICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSByZW5kZXJDYXJkKGNhcmREYXRhKTtcbiAgICAgICAgICBjYXJkU2VjdGlvbi5hZGRJdGVtKGNhcmRFbGVtZW50KTtcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICBcIi5nYWxsZXJ5X19saXN0XCJcbiAgICApO1xuICAgIGNhcmRTZWN0aW9uLnJlbmRlckl0ZW1zKCk7XG4gIH0pXG4gIC5jYXRjaChjb25zb2xlLmVycm9yKTtcblxuLypcbiAg4pSM4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSQXG4gIOKUgiBWQUxJREFUSU9OOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICDilIJcbiAg4pSU4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSYXG4gKi9cblxuY29uc3QgZm9ybVZhbGlkYXRvcnMgPSB7fTtcblxuY29uc3QgZW5hYmxlVmFsaWRhdGlvbiA9IChjb25maWcpID0+IHtcbiAgY29uc3QgZm9ybUxpc3QgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmZvcm1TZWxlY3RvcikpO1xuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xuICAgIGNvbnN0IHZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZywgZm9ybUVsZW1lbnQpO1xuICAgIGNvbnN0IGZvcm1OYW1lID0gZm9ybUVsZW1lbnQuZ2V0QXR0cmlidXRlKFwibmFtZVwiKTtcbiAgICBmb3JtVmFsaWRhdG9yc1tmb3JtTmFtZV0gPSB2YWxpZGF0b3I7XG4gICAgdmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbiAgfSk7XG59O1xuXG5lbmFibGVWYWxpZGF0aW9uKGNvbmZpZyk7XG5cbi8qXG4gIOKUjOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUkFxuICDilIIgUkVOREVSIENBUkQgRlVOQ1RJT05TICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg4pSCXG4gIOKUlOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUmFxuICovXG5cbmZ1bmN0aW9uIGhhbmRsZUNhcmRDbGljayh7IG5hbWUsIGxpbmsgfSkge1xuICBpbWFnZVByZXZpZXdQb3B1cC5vcGVuKG5hbWUsIGxpbmspO1xufVxuXG5mdW5jdGlvbiByZW5kZXJDYXJkKGNhcmREYXRhKSB7XG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gbmV3IENhcmQoXG4gICAgY2FyZERhdGEsXG4gICAgXCIjY2FyZC10ZW1wbGF0ZVwiLFxuICAgIGhhbmRsZUNhcmRDbGljayxcbiAgICBmdW5jdGlvbiBoYW5kbGVEZWxldGVDbGljaygpIHtcbiAgICAgIGNhcmREZWxldGVQb3B1cC5zZXRTdWJtaXRBY3Rpb24oKCkgPT4ge1xuICAgICAgICBjYXJkRGVsZXRlUG9wdXAuc2V0TG9hZGluZyh0cnVlKTtcbiAgICAgICAgYXBpXG4gICAgICAgICAgLnJlbW92ZUNhcmQoY2FyZERhdGEuX2lkKVxuICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICAgIGNhcmRFbGVtZW50LnJlbW92ZUNhcmRFbGVtZW50KHJlcy5faWQpO1xuICAgICAgICAgICAgY2FyZERlbGV0ZVBvcHVwLmNsb3NlKCk7XG4gICAgICAgICAgfSlcbiAgICAgICAgICAuY2F0Y2goY29uc29sZS5lcnJvcilcbiAgICAgICAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICAgICAgICBjYXJkRGVsZXRlUG9wdXAuc2V0TG9hZGluZyhmYWxzZSk7XG4gICAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICAgIGNhcmREZWxldGVQb3B1cC5vcGVuKCk7XG4gICAgfSxcbiAgICBmdW5jdGlvbiBoYW5kbGVMaWtlQnV0dG9uQ2xpY2soKSB7XG4gICAgICBhcGlcbiAgICAgICAgLmNoYW5nZUxpa2VTdGF0dXMoY2FyZERhdGEuX2lkLCBjYXJkRWxlbWVudC5pc0xpa2VkKVxuICAgICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgICAgY29uc29sZS5sb2cocmVzKTtcbiAgICAgICAgICBjYXJkRWxlbWVudC51cGRhdGVMaWtlcyhyZXMuaXNMaWtlZCk7XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaChjb25zb2xlLmVycm9yKTtcbiAgICB9XG4gICk7XG4gIHJldHVybiBjYXJkRWxlbWVudC5nZXRWaWV3KCk7XG59XG5cbi8qXG4gIOKUjOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUkFxuICDilIIgRVZFTlQgSEFORExFUlMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg4pSCXG4gIOKUlOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUmFxuICovXG5cbmZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0KHsgbmFtZSwgZGVzY3JpcHRpb24gfSkge1xuICBlZGl0UHJvZmlsZVBvcHVwLnNldExvYWRpbmcodHJ1ZSk7XG4gIGFwaVxuICAgIC51cGRhdGVVc2VySW5mbyhuYW1lLCBkZXNjcmlwdGlvbilcbiAgICAudGhlbigoKSA9PiB7XG4gICAgICB1c2VySW5mby5zZXRVc2VySW5mbyhuYW1lLCBkZXNjcmlwdGlvbik7XG4gICAgICBlZGl0UHJvZmlsZVBvcHVwLmNsb3NlKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goY29uc29sZS5lcnJvcilcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBlZGl0UHJvZmlsZVBvcHVwLnNldExvYWRpbmcoZmFsc2UpO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVDYXJkRm9ybVN1Ym1pdCh7IG5hbWUsIGxpbmsgfSkge1xuICBhZGRDYXJkUG9wdXAuc2V0TG9hZGluZyh0cnVlKTtcbiAgYXBpXG4gICAgLmFkZENhcmQoeyBuYW1lLCBsaW5rIH0pXG4gICAgLnRoZW4oKGNhcmREYXRhKSA9PiB7XG4gICAgICBjb25zdCBjYXJkRWxlbWVudCA9IHJlbmRlckNhcmQoY2FyZERhdGEpO1xuICAgICAgY2FyZFNlY3Rpb24ucHJlcGVuZEl0ZW0oY2FyZEVsZW1lbnQpO1xuICAgICAgYWRkQ2FyZFBvcHVwLmNsb3NlKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goY29uc29sZS5lcnJvcilcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBhZGRDYXJkUG9wdXAuc2V0TG9hZGluZyhmYWxzZSk7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUF2YXRhckZvcm1TdWJtaXQoeyB1cmwgfSkge1xuICBhdmF0YXJFZGl0UG9wdXAuc2V0TG9hZGluZyh0cnVlKTtcbiAgYXBpXG4gICAgLnNldFVzZXJBdmF0YXIodXJsKVxuICAgIC50aGVuKCh1c2VyRGF0YSkgPT4ge1xuICAgICAgdXNlckluZm8uc2V0VXNlckF2YXRhcih1c2VyRGF0YS5hdmF0YXIpO1xuICAgICAgYXZhdGFyRWRpdFBvcHVwLmNsb3NlKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goY29uc29sZS5lcnJvcilcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBhdmF0YXJFZGl0UG9wdXAuc2V0TG9hZGluZyhmYWxzZSk7XG4gICAgfSk7XG59XG5cbi8qXG4gIOKUjOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUkFxuICDilIIgRVZFTlQgTElTVEVORVJTICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg4pSCXG4gIOKUlOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUmFxuICovXG5cbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNvbnN0IHsgcHJvZmlsZU5hbWUsIGRlc2NyaXB0aW9uIH0gPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xuICBpbnB1dE5hbWUudmFsdWUgPSBwcm9maWxlTmFtZTtcbiAgaW5wdXREZXNjcmlwdGlvbi52YWx1ZSA9IGRlc2NyaXB0aW9uO1xuICBlZGl0UHJvZmlsZVBvcHVwLm9wZW4oKTtcbiAgZm9ybVZhbGlkYXRvcnNbXCJwcm9maWxlLWZvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XG59KTtcblxuY2FyZEFkZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBhZGRDYXJkUG9wdXAub3BlbigpO1xuICBmb3JtVmFsaWRhdG9yc1tcImNhcmQtZm9ybVwiXS5yZXNldFZhbGlkYXRpb24oKTtcbn0pO1xuXG5hdmF0YXJFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGF2YXRhckVkaXRQb3B1cC5vcGVuKCk7XG4gIGZvcm1WYWxpZGF0b3JzW1wiYXZhdGFyLWZvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XG59KTtcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XG4gICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XG4gIH1cblxuICBfaGFuZGxlU2VydmVyUmVzcG9uc2UocmVzKSB7XG4gICAgcmV0dXJuIHJlcy5vayA/IHJlcy5qc29uKCkgOiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgfVxuXG4gIF9yZXF1ZXN0KHVybCwgb3B0aW9ucykge1xuICAgIHJldHVybiBmZXRjaCh1cmwsIG9wdGlvbnMpLnRoZW4odGhpcy5faGFuZGxlU2VydmVyUmVzcG9uc2UpO1xuICB9XG5cbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwgeyBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzIH0pO1xuICB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pO1xuICB9XG5cbiAgYWRkQ2FyZCh7IG5hbWUsIGxpbmsgfSkge1xuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWUsXG4gICAgICAgIGxpbmssXG4gICAgICB9KSxcbiAgICB9KTtcbiAgfVxuXG4gIHJlbW92ZUNhcmQoY2FyZElkKSB7XG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KTtcbiAgfVxuXG4gIGNoYW5nZUxpa2VTdGF0dXMoY2FyZElkLCBpc0xpa2VkKSB7XG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xuICAgICAgbWV0aG9kOiBpc0xpa2VkID8gXCJERUxFVEVcIiA6IFwiUFVUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pO1xuICB9XG5cbiAgdXBkYXRlVXNlckluZm8obmFtZSwgZGVzY3JpcHRpb24pIHtcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZTogbmFtZSxcbiAgICAgICAgYWJvdXQ6IGRlc2NyaXB0aW9uLFxuICAgICAgfSksXG4gICAgfSk7XG4gIH1cblxuICBzZXRVc2VyQXZhdGFyKHVybCkge1xuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgYXZhdGFyOiB1cmwsXG4gICAgICB9KSxcbiAgICB9KTtcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xuICAgIHRoaXMuX3ByZXZpZXdJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlXCIpO1xuICAgIHRoaXMuX3ByZXZpZXdDYXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fcHJldmlldy1jYXB0aW9uXCIpO1xuICB9XG5cbiAgb3BlbihuYW1lLCBsaW5rKSB7XG4gICAgdGhpcy5fcHJldmlld0ltYWdlLnNyYyA9IGxpbms7XG4gICAgdGhpcy5fcHJldmlld0NhcHRpb24udGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHRoaXMuX3ByZXZpZXdJbWFnZS5hbHQgPSBgUGhvdG8gb2YgJHtuYW1lfWA7XG4gICAgc3VwZXIub3BlbigpO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoQ29uZmlybSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvcihcIi5mb3JtX19idXR0b25cIik7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uVGV4dCA9IHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudDtcbiAgfVxuXG4gIHNldFN1Ym1pdEFjdGlvbihhY3Rpb24pIHtcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gYWN0aW9uO1xuICB9XG5cbiAgc2V0TG9hZGluZyhpc0xvYWRpbmcsIGxvYWRpbmdUZXh0ID0gXCJSZW1vdmluZy4uLlwiKSB7XG4gICAgaWYgKGlzTG9hZGluZykge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gbG9hZGluZ1RleHQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuX3N1Ym1pdEJ1dHRvblRleHQ7XG4gICAgfVxuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgc3VwZXIuY2xvc2UoKTtcbiAgICB0aGlzLl9wb3B1cEZvcm0ucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KTtcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcbiAgY29uc3RydWN0b3IobmFtZSwgZGVzY3JpcHRpb24sIGF2YXRhcikge1xuICAgIHRoaXMuX25hbWVFbGVtZW50ID0gbmFtZTtcbiAgICB0aGlzLl9kZXNjcmlwRWxlbWVudCA9IGRlc2NyaXB0aW9uO1xuICAgIHRoaXMuX2F2YXRhckVsZW1lbnQgPSBhdmF0YXI7XG4gIH1cblxuICBnZXRVc2VySW5mbygpIHtcbiAgICBjb25zdCBwcm9maWxlT2JqZWN0ID0ge307XG4gICAgcHJvZmlsZU9iamVjdFtcInByb2ZpbGVOYW1lXCJdID0gdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQ7XG4gICAgcHJvZmlsZU9iamVjdFtcImRlc2NyaXB0aW9uXCJdID0gdGhpcy5fZGVzY3JpcEVsZW1lbnQudGV4dENvbnRlbnQ7XG4gICAgcmV0dXJuIHByb2ZpbGVPYmplY3Q7XG4gIH1cblxuICBzZXRVc2VySW5mbyhuYW1lLCBkZXNjcmlwdGlvbikge1xuICAgIHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50ID0gbmFtZTtcbiAgICB0aGlzLl9kZXNjcmlwRWxlbWVudC50ZXh0Q29udGVudCA9IGRlc2NyaXB0aW9uO1xuICB9XG5cbiAgc2V0VXNlckF2YXRhcihhdmF0YXIpIHtcbiAgICB0aGlzLl9hdmF0YXJFbGVtZW50LnNyYyA9IGF2YXRhcjtcbiAgICB0aGlzLl9hdmF0YXJFbGVtZW50LmFsdCA9IHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50O1xuICB9XG59XG4iLCJjbGFzcyBDYXJkIHtcbiAgY29uc3RydWN0b3IoXG4gICAgY2FyZERhdGEsXG4gICAgY2FyZFRlbXBsYXRlU2VsZWN0b3IsXG4gICAgaGFuZGxlQ2FyZENsaWNrLFxuICAgIGhhbmRsZURlbGV0ZUNsaWNrLFxuICAgIGhhbmRsZUxpa2VCdXR0b25DbGlja1xuICApIHtcbiAgICB0aGlzLl9uYW1lID0gY2FyZERhdGEubmFtZTtcbiAgICB0aGlzLl9saW5rID0gY2FyZERhdGEubGluaztcbiAgICB0aGlzLmlzTGlrZWQgPSBjYXJkRGF0YS5pc0xpa2VkO1xuICAgIHRoaXMuX293bmVySWQgPSBjYXJkRGF0YS5vd25lci5faWQ7XG4gICAgdGhpcy5fY2FyZElkID0gY2FyZERhdGEuX2lkO1xuXG4gICAgdGhpcy5fY2FyZFRlbXBsYXRlU2VsZWN0b3IgPSBjYXJkVGVtcGxhdGVTZWxlY3RvcjtcbiAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2sgPSBoYW5kbGVEZWxldGVDbGljaztcbiAgICB0aGlzLl9oYW5kbGVMaWtlQnV0dG9uQ2xpY2sgPSBoYW5kbGVMaWtlQnV0dG9uQ2xpY2s7XG4gIH1cblxuICBfdG9nZ2xlTGlrZUJ1dHRvbigpIHtcbiAgICBpZiAodGhpcy5pc0xpa2VkKSB7XG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LnJlbW92ZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcbiAgICB9XG4gIH1cblxuICB1cGRhdGVMaWtlcyhpc0xpa2VkKSB7XG4gICAgdGhpcy5pc0xpa2VkID0gaXNMaWtlZDtcbiAgICB0aGlzLl90b2dnbGVMaWtlQnV0dG9uKCk7XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fY2FyZEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2soeyBuYW1lOiB0aGlzLl9uYW1lLCBsaW5rOiB0aGlzLl9saW5rIH0pO1xuICAgIH0pO1xuICAgIHRoaXMuX2xpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZUxpa2VCdXR0b25DbGljaygpO1xuICAgIH0pO1xuICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT5cbiAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrKClcbiAgICApO1xuICB9XG5cbiAgcmVtb3ZlQ2FyZEVsZW1lbnQoKSB7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucmVtb3ZlKCk7XG4gIH1cblxuICBfZ2V0VGVtcGxhdGUoKSB7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFRlbXBsYXRlU2VsZWN0b3IpXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgcmV0dXJuIHRoaXMuX2NhcmRFbGVtZW50O1xuICB9XG5cbiAgZ2V0VmlldygpIHtcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XG4gICAgdGhpcy5fY2FyZEltYWdlID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcbiAgICB0aGlzLl9jYXJkVGl0bGUgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpO1xuICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xuICAgIHRoaXMuX2xpa2VDb3VudGVyID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWNvdW50ZXJcIik7XG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIlxuICAgICk7XG4gICAgdGhpcy5fY2FyZEltYWdlLnNyYyA9IHRoaXMuX2xpbms7XG4gICAgdGhpcy5fY2FyZFRpdGxlLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWx0ID0gYFBob3RvIG9mICR7dGhpcy5fbmFtZX1gO1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fdG9nZ2xlTGlrZUJ1dHRvbigpO1xuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBDYXJkO1xuIiwiY2xhc3MgRm9ybVZhbGlkYXRvciB7XG4gIGNvbnN0cnVjdG9yKGNvbmZpZywgZm9ybUVsZW1lbnQpIHtcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gY29uZmlnLmlucHV0U2VsZWN0b3I7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBjb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3I7XG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IGNvbmZpZy5pbnB1dEVycm9yQ2xhc3M7XG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IGNvbmZpZy5lcnJvckNsYXNzO1xuICAgIHRoaXMuX2Zvcm0gPSBmb3JtRWxlbWVudDtcbiAgfVxuXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbGVtID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKFxuICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXG4gICAgKTtcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yTWVzc2FnZUVsZW0udGV4dENvbnRlbnQgPSBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2U7XG4gICAgZXJyb3JNZXNzYWdlRWxlbS5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICB9XG5cbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xuICAgIGNvbnN0IGVycm9yTWVzc2FnZUVsZW0gPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcbiAgICApO1xuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgZXJyb3JNZXNzYWdlRWxlbS50ZXh0Q29udGVudCA9IFwiXCI7XG4gICAgZXJyb3JNZXNzYWdlRWxlbS5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICB9XG5cbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgdGhpcy5faW5wdXRFbGVtZW50cy5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XG4gICAgfSk7XG4gIH1cblxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XG4gICAgICB0aGlzLl9kaXNhYmxlQnV0dG9uKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZTtcbiAgICB9XG4gIH1cblxuICBfaGFzSW52YWxpZElucHV0KCkge1xuICAgIHJldHVybiB0aGlzLl9pbnB1dEVsZW1lbnRzLnNvbWUoKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgcmV0dXJuICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQ7XG4gICAgfSk7XG4gIH1cblxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH1cbiAgfVxuXG4gIF9kaXNhYmxlQnV0dG9uKCkge1xuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzID0gWy4uLnRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKV07XG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XG5cbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzLmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgfVxuXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH0pO1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgRm9ybVZhbGlkYXRvcjtcbiJdLCJuYW1lcyI6WyJTZWN0aW9uIiwiY29uc3RydWN0b3IiLCJfcmVmIiwiY29udGFpbmVyU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwidGhpcyIsIl9yZW5kZXJlZEl0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsInJlbmRlckl0ZW1zIiwiZm9yRWFjaCIsIml0ZW0iLCJhZGRJdGVtIiwiZWxlbWVudCIsImFwcGVuZCIsInByZXBlbmRJdGVtIiwicHJlcGVuZCIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cEVsZW1lbnQiLCJfaGFuZGxlRXNjQ2xvc2UiLCJiaW5kIiwiX2hhbmRsZUNsaWNrQ2xvc2UiLCJvcGVuIiwiY2xhc3NMaXN0IiwiYWRkIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJjbG9zZSIsInJlbW92ZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJldnQiLCJrZXkiLCJ0YXJnZXQiLCJjb250YWlucyIsImFkZEV2ZW50TGlzdGVuZXIiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX3BvcHVwRm9ybSIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX2lucHV0cyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJfc3VibWl0QnV0dG9uIiwiX3N1Ym1pdEJ1dHRvblRleHQiLCJ0ZXh0Q29udGVudCIsInNldExvYWRpbmciLCJpc0xvYWRpbmciLCJsb2FkaW5nVGV4dCIsImFyZ3VtZW50cyIsImxlbmd0aCIsInVuZGVmaW5lZCIsIl9nZXRJbnB1dFZhbHVlcyIsImlucHV0c09iaiIsImlucHV0IiwibmFtZSIsInZhbHVlIiwiX3N1Ym1pdEZvcm0iLCJpbnB1dFZhbHVlcyIsInJlc2V0IiwicHJvZmlsZUVkaXRCdXR0b24iLCJpbnB1dE5hbWUiLCJpbnB1dERlc2NyaXB0aW9uIiwiY2FyZEFkZEJ1dHRvbiIsImF2YXRhckVkaXRCdXR0b24iLCJhcGkiLCJiYXNlVXJsIiwiaGVhZGVycyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJfaGFuZGxlU2VydmVyUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiX3JlcXVlc3QiLCJ1cmwiLCJvcHRpb25zIiwiZmV0Y2giLCJ0aGVuIiwiZ2V0SW5pdGlhbENhcmRzIiwiZ2V0VXNlckluZm8iLCJhZGRDYXJkIiwiX3JlZjIiLCJsaW5rIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJyZW1vdmVDYXJkIiwiY2FyZElkIiwiY2hhbmdlTGlrZVN0YXR1cyIsImlzTGlrZWQiLCJ1cGRhdGVVc2VySW5mbyIsImRlc2NyaXB0aW9uIiwiYWJvdXQiLCJzZXRVc2VyQXZhdGFyIiwiYXZhdGFyIiwiYXV0aG9yaXphdGlvbiIsImNhcmRTZWN0aW9uIiwidXNlcklkIiwiaW1hZ2VQcmV2aWV3UG9wdXAiLCJfcHJldmlld0ltYWdlIiwiX3ByZXZpZXdDYXB0aW9uIiwic3JjIiwiYWx0IiwiYWRkQ2FyZFBvcHVwIiwiX3JlZjQiLCJjYXJkRGF0YSIsImNhcmRFbGVtZW50IiwicmVuZGVyQ2FyZCIsImNhdGNoIiwiY29uc29sZSIsImVycm9yIiwiZmluYWxseSIsImVkaXRQcm9maWxlUG9wdXAiLCJfcmVmMyIsInVzZXJJbmZvIiwic2V0VXNlckluZm8iLCJjYXJkRGVsZXRlUG9wdXAiLCJzZXRTdWJtaXRBY3Rpb24iLCJhY3Rpb24iLCJhdmF0YXJFZGl0UG9wdXAiLCJfcmVmNSIsInVzZXJEYXRhIiwiX25hbWVFbGVtZW50IiwiX2Rlc2NyaXBFbGVtZW50IiwiX2F2YXRhckVsZW1lbnQiLCJwcm9maWxlT2JqZWN0IiwiYWxsIiwiaW5pdGlhbENhcmRzIiwiX2lkIiwiZm9ybVZhbGlkYXRvcnMiLCJoYW5kbGVDYXJkQ2xpY2siLCJjYXJkVGVtcGxhdGVTZWxlY3RvciIsImhhbmRsZURlbGV0ZUNsaWNrIiwiaGFuZGxlTGlrZUJ1dHRvbkNsaWNrIiwiX25hbWUiLCJfbGluayIsIl9vd25lcklkIiwib3duZXIiLCJfY2FyZElkIiwiX2NhcmRUZW1wbGF0ZVNlbGVjdG9yIiwiX2hhbmRsZUNhcmRDbGljayIsIl9oYW5kbGVEZWxldGVDbGljayIsIl9oYW5kbGVMaWtlQnV0dG9uQ2xpY2siLCJfdG9nZ2xlTGlrZUJ1dHRvbiIsIl9saWtlQnV0dG9uIiwidXBkYXRlTGlrZXMiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJfY2FyZEltYWdlIiwiX2RlbGV0ZUJ1dHRvbiIsInJlbW92ZUNhcmRFbGVtZW50IiwiX2NhcmRFbGVtZW50IiwiX2dldFRlbXBsYXRlIiwiY29udGVudCIsImNsb25lTm9kZSIsImdldFZpZXciLCJfY2FyZFRpdGxlIiwiX2xpa2VDb3VudGVyIiwibG9nIiwiY29uZmlnIiwiZm9ybVNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJBcnJheSIsImZyb20iLCJmb3JtRWxlbWVudCIsInZhbGlkYXRvciIsIl9pbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJfZm9ybSIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWxlbWVudCIsImVycm9yTWVzc2FnZUVsZW0iLCJpZCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hpZGVJbnB1dEVycm9yIiwicmVzZXRWYWxpZGF0aW9uIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiX2lucHV0RWxlbWVudHMiLCJfaGFzSW52YWxpZElucHV0IiwiX2Rpc2FibGVCdXR0b24iLCJfYnV0dG9uRWxlbWVudCIsImRpc2FibGVkIiwic29tZSIsInZhbGlkaXR5IiwidmFsaWQiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwiZW5hYmxlVmFsaWRhdGlvbiIsInByZXZlbnREZWZhdWx0IiwiZm9ybU5hbWUiLCJnZXRBdHRyaWJ1dGUiLCJwcm9maWxlTmFtZSJdLCJzb3VyY2VSb290IjoiIn0=